From b96c240ef326de372d85199e8d8bc5a3dd3660b2 Mon Sep 17 00:00:00 2001
From: Julian Winkler <julian.winkler1@web.de>
Date: Thu, 21 Feb 2019 10:10:08 +0100
Subject: [PATCH] ignore text relocations

Change-Id: I8e30983f007908d3dd607cd42ff49224a9923fd4
---
 linker/linker.cpp | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/linker/linker.cpp b/linker/linker.cpp
index 951351c32..3194825f6 100644
--- a/linker/linker.cpp
+++ b/linker/linker.cpp
@@ -3620,13 +3620,13 @@ bool soinfo::link_image(const soinfo_list_t& global_group, const soinfo_list_t&
 #if !defined(__LP64__)
   if (has_text_relocations) {
     // Fail if app is targeting M or above.
-    int app_target_api_level = get_application_target_sdk_version();
+    /*int app_target_api_level = get_application_target_sdk_version();
     if (app_target_api_level >= __ANDROID_API_M__) {
       DL_ERR_AND_LOG("\"%s\" has text relocations (https://android.googlesource.com/platform/"
                      "bionic/+/master/android-changes-for-ndk-developers.md#Text-Relocations-"
                      "Enforced-for-API-level-23)", get_realpath());
       return false;
-    }
+    }*/
     // Make segments writable to allow text relocations to work properly. We will later call
     // phdr_table_protect_segments() after all of them are applied.
     DL_WARN_documented_change(__ANDROID_API_M__,
-- 
2.20.1

