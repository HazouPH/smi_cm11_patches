From 9bede581c6dd4dc05ac586dc49dda815864b2c1f Mon Sep 17 00:00:00 2001
From: niks255 <niks255@mail.ru>
Date: Sun, 27 Nov 2016 01:40:05 +0600
Subject: [PATCH 06/10] Show warning in performance settings only once

Change-Id: I9dc937bf005a9c8d50bc75478dbc2b66fd466d8a
---
 .../android/settings/cyanogenmod/PerformanceSettings.java | 15 ++++++++++++++-
 1 file changed, 14 insertions(+), 1 deletion(-)

diff --git a/src/com/android/settings/cyanogenmod/PerformanceSettings.java b/src/com/android/settings/cyanogenmod/PerformanceSettings.java
index 15a93ac..62fb8ac 100644
--- a/src/com/android/settings/cyanogenmod/PerformanceSettings.java
+++ b/src/com/android/settings/cyanogenmod/PerformanceSettings.java
@@ -16,11 +16,13 @@
 
 package com.android.settings.cyanogenmod;
 
+import android.app.Activity;
 import android.app.ActivityManager;
 import android.app.AlertDialog;
 import android.content.ContentResolver;
 import android.content.Context;
 import android.content.DialogInterface;
+import android.content.SharedPreferences;
 import android.database.ContentObserver;
 import android.net.Uri;
 import android.os.Bundle;
@@ -71,6 +73,8 @@ public class PerformanceSettings extends SettingsPreferenceFragment implements
 
     private PowerManager mPowerManager;
 
+    private SharedPreferences mPreference;
+
     private class PerformanceProfileObserver extends ContentObserver {
         public PerformanceProfileObserver(Handler handler) {
             super(handler);
@@ -127,6 +131,8 @@ public class PerformanceSettings extends SettingsPreferenceFragment implements
             category.removePreference(findPreference(FORCE_HIGHEND_GFX_PREF));
         }
 
+        mPreference = getActivity().getSharedPreferences("performance_settings", Activity.MODE_PRIVATE);
+
         /* Display the warning dialog */
         alertDialog = new AlertDialog.Builder(getActivity()).create();
         alertDialog.setTitle(R.string.performance_settings_warning_title);
@@ -136,10 +142,17 @@ public class PerformanceSettings extends SettingsPreferenceFragment implements
                 getResources().getString(com.android.internal.R.string.ok),
                 new DialogInterface.OnClickListener() {
                     public void onClick(DialogInterface dialog, int which) {
+                        mPreference
+                            .edit()
+                            .putBoolean("warning_shown", true)
+                            .commit();
                         return;
                     }
                 });
-        alertDialog.show();
+
+        if (savedInstanceState == null && !mPreference.getBoolean("warning_shown", false)) {
+            alertDialog.show();
+        }
     }
 
     @Override
-- 
2.7.4

